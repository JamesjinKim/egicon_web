# Dashboard.js 아키텍처 다이어그램

**작성일**: 2025년 7월 16일  
**버전**: 리팩토링 후 최종 구조  
**파일 크기**: 3270줄 (617줄 감소, 15.9% 축소)

## 🏗️ 전체 아키텍처 구조

```
┌─────────────────────────────────────────────────────────────────┐
│                        브라우저 (Client)                          │
├─────────────────────────────────────────────────────────────────┤
│                       index.html                                 │
│                    (ES6 Module 로드)                            │
└─────────────────────────┬───────────────────────────────────────┘
                         │ import
                         ▼
┌─────────────────────────────────────────────────────────────────┐
│                    dashboard.js                                  │
│                   (메인 오케스트레이터)                           │
│                      3270 줄                                     │
└─────────────────────────────────────────────────────────────────┘
```

## 🎯 현재 dashboard.js의 핵심 기능

```
┌─────────────────────────────────────────────────────────────────┐
│                    EGIconDashboard Class                         │
│                   (메인 컨트롤러 - 3270줄)                       │
├─────────────────────────────────────────────────────────────────┤
│  🎯 핵심 책임:                                                   │
│  1. 시스템 초기화 및 생명주기 관리                                │
│  2. 모듈 간 조정 및 통합                                         │
│  3. WebSocket 실시간 통신 관리                                   │
│  4. 센서 데이터 수집 및 배포                                     │
│  5. UI 이벤트 처리                                              │
│  6. 상태 관리 및 업데이트                                        │
└─────────────────────────────────────────────────────────────────┘
```

## 🔄 모듈 의존성 및 상호작용 다이어그램

```
                    ┌─────────────────────────────────────────────┐
                    │           dashboard.js                       │
                    │        (메인 오케스트레이터)                │
                    │                                             │
                    │  📋 주요 메서드:                           │
                    │  • init() - 시스템 초기화                  │
                    │  • loadSensorGroups() - 동적 센서 그룹 로드│
                    │  • startRealtimeConnection() - WebSocket   │
                    │  • handleRealtimeData() - 실시간 데이터 처리│
                    │  • initSidebarEvents() - UI 이벤트 처리    │
                    │  • updateStatusBar() - 상태 업데이트       │
                    └─────────────────────────┬───────────────────┘
                                             │
                    ┌────────────────────────┼────────────────────────┐
                    │                        │                        │
                    ▼                        ▼                        ▼
        ┌─────────────────────┐  ┌─────────────────────┐  ┌─────────────────────┐
        │   config/ 모듈들    │  │   managers/ 모듈들   │  │   utils/ 모듈들     │
        │                     │  │                     │  │                     │
        │ 📁 sensor-groups.js │  │ 📁 chart-manager.js │  │ 📁 helpers.js      │
        │ 📁 sensor-types.js  │  │                     │  │                     │
        │ 📁 dashboard-config │  │                     │  │                     │
        └─────────────────────┘  └─────────────────────┘  └─────────────────────┘
```

## 📊 각 모듈의 역할과 상호작용

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                          모듈별 역할 및 상호작용                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  🎮 dashboard.js (메인 컨트롤러)                                                │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │ • 시스템 전체 생명주기 관리                                              │    │
│  │ • 모듈 간 의존성 주입 및 연결                                           │    │
│  │ • WebSocket 통신 관리                                                   │    │
│  │ • 실시간 데이터 수집 및 분배                                            │    │
│  │ • UI 이벤트 처리 및 상태 관리                                           │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                 │
│  📁 config/ (설정 모듈들)                                                      │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │ sensor-groups.js   → 센서 그룹 정의 (온습도, 기압, 조도 등)             │    │
│  │ sensor-types.js    → 센서 타입 메타데이터 (단위, 범위, 색상)             │    │
│  │ dashboard-config.js → 성능 설정 (업데이트 주기, 데이터 포인트 등)        │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                 │
│  📁 managers/ (관리자 모듈들)                                                  │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │ chart-manager.js → 차트 생성/업데이트/파괴 전담                          │    │
│  │                  • Chart.js 인스턴스 관리                               │    │
│  │                  • 차트 설정 및 스타일링                                │    │
│  │                  • 메모리 최적화 (차트 파괴)                            │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                 │
│  📁 utils/ (유틸리티 모듈들)                                                   │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │ helpers.js → 순수 함수들                                                │    │
│  │            • 색상 팔레트 생성                                           │    │
│  │            • 센서 ID 파싱                                               │    │
│  │            • 안전한 타입 변환                                           │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## 🔄 데이터 흐름도

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              데이터 흐름                                        │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  1️⃣ 초기화 단계                                                                │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │ dashboard.js.init()                                                     │    │
│  │         │                                                               │    │
│  │         ├─→ config/sensor-groups.js (센서 그룹 로드)                     │    │
│  │         ├─→ config/sensor-types.js (센서 타입 로드)                      │    │
│  │         ├─→ config/dashboard-config.js (성능 설정 로드)                  │    │
│  │         └─→ managers/chart-manager.js (차트 초기화)                      │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                 │
│  2️⃣ 실시간 데이터 처리                                                         │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │ WebSocket 서버                                                          │    │
│  │         │                                                               │    │
│  │         ▼                                                               │    │
│  │ dashboard.js.handleRealtimeData()                                       │    │
│  │         │                                                               │    │
│  │         ├─→ utils/helpers.js (데이터 파싱/변환)                          │    │
│  │         ├─→ managers/chart-manager.js (차트 업데이트)                    │    │
│  │         └─→ DOM 업데이트                                                 │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                 │
│  3️⃣ 사용자 상호작용                                                            │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │ 사용자 이벤트 (클릭, 필터 등)                                             │    │
│  │         │                                                               │    │
│  │         ▼                                                               │    │
│  │ dashboard.js.initSidebarEvents()                                        │    │
│  │         │                                                               │    │
│  │         ├─→ config/sensor-groups.js (그룹 정보 참조)                     │    │
│  │         ├─→ managers/chart-manager.js (차트 필터링)                      │    │
│  │         └─→ UI 상태 업데이트                                             │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## 🎯 SOLID 원칙 적용 결과

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         SOLID 원칙 적용 현황                                    │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  🎯 S - 단일 책임 원칙 (Single Responsibility Principle)                        │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │ ✅ dashboard.js → 시스템 조정 및 통합만 담당                              │    │
│  │ ✅ chart-manager.js → 차트 관리만 담당                                    │    │
│  │ ✅ helpers.js → 유틸리티 함수만 담당                                      │    │
│  │ ✅ config/*.js → 설정 정보만 담당                                         │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                 │
│  🔓 O - 개방-폐쇄 원칙 (Open-Closed Principle)                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │ ✅ 새로운 센서 타입 추가 시 config/sensor-types.js만 수정               │    │
│  │ ✅ 새로운 센서 그룹 추가 시 config/sensor-groups.js만 수정              │    │
│  │ ✅ 기존 코드 변경 없이 확장 가능                                          │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                 │
│  🔄 D - 의존성 역전 원칙 (Dependency Inversion Principle)                      │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │ ✅ dashboard.js가 구체적인 차트 구현에 의존하지 않고                       │    │
│  │    추상화된 ChartManager에 의존                                          │    │
│  │ ✅ 설정 정보를 외부 모듈로 주입받아 사용                                  │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## 📊 성과 요약

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                            리팩토링 성과                                        │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  📊 정량적 성과                                                                │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │ • 파일 크기: 3887줄 → 3270줄 (617줄 감소, 15.9% 축소)                   │    │
│  │ • 모듈 수: 1개 → 7개 (관리 편의성 향상)                                 │    │
│  │ • 코드 중복: 차트 생성 로직 중복 제거                                    │    │
│  │ • 재사용성: 유틸리티 함수 5개 독립 모듈화                               │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                 │
│  🎯 정성적 성과                                                                │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │ • 관심사 분리: 각 모듈이 명확한 책임을 가짐                              │    │
│  │ • 테스트 용이성: 개별 모듈 단위 테스트 가능                              │    │
│  │ • 확장성: 새로운 기능 추가 시 설정만 수정                               │    │
│  │ • 유지보수성: 특정 기능 수정 시 해당 모듈만 변경                         │    │
│  │ • 코드 품질: SOLID 원칙 적용으로 구조적 품질 향상                        │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## 🎉 결론

**현재 dashboard.js**는 더 이상 모든 것을 담당하는 거대한 클래스가 아니라, **시스템 전체를 조정하고 통합하는 메인 컨트롤러**의 역할을 합니다. 각 모듈은 명확한 책임을 가지고 있으며, SOLID 원칙을 준수하여 유지보수성과 확장성이 크게 향상되었습니다.

---

**참고 문서**:
- [REFACTORING_2025_07_16.md](./REFACTORING_2025_07_16.md) - 상세한 리팩토링 보고서
- [CLAUDE.md](./CLAUDE.md) - 개발 환경 가이드
- [README.md](./README.md) - 프로젝트 전체 문서